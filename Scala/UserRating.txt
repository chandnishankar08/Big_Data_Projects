val user=sc.textFile("assignment3/user.csv").map(line=>line.split("\\^"))
val review=sc.textFile("assignment3/review.csv").map(line=>line.split("\\^"))
val sumofstars=review.map(line=>(line(1),line(3).toDouble)).reduceByKey((a,b)=>a+b).distinct
val count=review.map(line=>(line(1),1)).reduceByKey((a,b)=>a+b).distinct
val sumandcount=sumofstars.join(count)
val reviewAvg=sumandcount.map(a=>(a._1,a._2._1/a._2._2))
val username=Console.readLine()
val userData=user.filter(line=>line(1).contains(username)).map(line=>(line(0).toString,line(1).toString))
val res=reviewAvg.join(userData).collect()
finalres.foreach(line=>println(line._1,line._2._2, line._2._1))